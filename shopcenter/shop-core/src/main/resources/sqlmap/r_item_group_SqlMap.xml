<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="r_item_group">
    <typeAlias alias="RItemGroupDO" type="com.mockuai.shopcenter.core.domain.RItemGroupDO"/>
    <typeAlias alias="RItemGroupQTO" type="com.mockuai.shopcenter.domain.qto.RItemGroupQTO"/>
    <typeAlias alias="ShopItemGroupQTO" type="com.mockuai.shopcenter.domain.qto.ShopItemGroupQTO"/>
    <typeAlias alias="ShopItemGroupDTO" type="com.mockuai.shopcenter.domain.dto.ShopItemGroupDTO"/>
    <resultMap class="com.mockuai.shopcenter.core.domain.RItemGroupDO" id="BaseResultMap">
        <result column="id" jdbcType="BIGINT" property="id"/>
        <result column="biz_code" jdbcType="VARCHAR" property="bizCode"/>
        <result column="seller_id" jdbcType="BIGINT" property="sellerId"/>
        <result column="group_id" jdbcType="BIGINT" property="groupId"/>
        <result column="item_id" jdbcType="BIGINT" property="itemId"/>
        <result column="delete_mark" jdbcType="TINYINT" property="deleteMark"/>
        <result column="delete_version" jdbcType="BIGINT" property="deleteVersion"/>
        <result column="gmt_created" jdbcType="TIMESTAMP" property="gmtCreated"/>
        <result column="gmt_modified" jdbcType="TIMESTAMP" property="gmtModified"/>
    </resultMap>

    <resultMap id="ItemCountMap" class="ShopItemGroupDTO">
        <result property="id" column="group_id" javaType="java.lang.Long"/>
        <result property="count" column="count" javaType="java.lang.Integer"/>
    </resultMap>

    <sql id="Example_Where_Clause">

    </sql>

    <sql id="Base_Column_List">
        id, biz_code, seller_id, group_id, item_id, delete_mark, delete_version, gmt_created,
        gmt_modified
    </sql>

    <select id="queryRItemGroupByGroupId" parameterClass="RItemGroupDO" resultMap="BaseResultMap">
        select
        <include refid="r_item_group.Base_Column_List"/>
        from r_item_group
        where group_id = #groupId:BIGINT# and seller_id = seller_id and biz_code = #bizCode# and delete_mark = 0
    </select>

    <select id="queryGroupItemCount" parameterClass="RItemGroupQTO" resultMap="ItemCountMap">
        select
        group_id,count(item_id) as count
        from r_item_group
        where  seller_id = #sellerId# and biz_code = #bizCode# and delete_mark = 0
        <isNotNull property="groupIdList">
            <isNotEmpty property="groupIdList" prepend="AND">
                group_id in
                <iterate property="groupIdList" conjunction="," open="(" close=")">
                    #groupIdList[]#
                </iterate>
            </isNotEmpty>
        </isNotNull>
        group by group_id
    </select>

    <select id="getRItemGroup" parameterClass="RItemGroupDO" resultMap="BaseResultMap">
        select
        <include refid="r_item_group.Base_Column_List"/>
        from r_item_group
        where id = #id:BIGINT# and seller_id = seller_id and biz_code = #bizCode#
    </select>

    <update id="deleteRItemGroup" parameterClass="RItemGroupDO">
        update r_item_group
        set delete_mark = 1,delete_version = id,gmt_modified = now()
        where id = #id:BIGINT# and seller_id = #sellerId# and biz_code = #bizCode#
    </update>

    <update id="deleteRItemGroupByGroupId" parameterClass="RItemGroupDO">
        update r_item_group
        set delete_mark = 1,delete_version = id,gmt_modified = now()
        where group_id = #groupId:BIGINT# and seller_id = #sellerId# and biz_code = #bizCode#
    </update>

    <insert id="addRItemGroup" parameterClass="RItemGroupDO">
        insert into r_item_group (id, biz_code, seller_id, group_id, item_id,
        delete_mark, delete_version, gmt_created, gmt_modified
        )
        values (#id:BIGINT#, #bizCode:VARCHAR#, #sellerId:BIGINT#, #groupId:BIGINT#, #itemId:BIGINT#,
        0,0,now(),now()
        )
    </insert>

    <insert id="insertSelective" parameterClass="com.mockuai.shopcenter.core.domain.RItemGroupDO">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Wed May 11 10:37:16 CST 2016.
        -->
        insert into r_item_group
        <dynamic prepend="(">
            <isNotNull prepend="," property="id">
                id
            </isNotNull>
            <isNotNull prepend="," property="bizCode">
                biz_code
            </isNotNull>
            <isNotNull prepend="," property="sellerId">
                seller_id
            </isNotNull>
            <isNotNull prepend="," property="groupId">
                group_id
            </isNotNull>
            <isNotNull prepend="," property="itemId">
                item_id
            </isNotNull>
            <isNotNull prepend="," property="deleteMark">
                delete_mark
            </isNotNull>
            <isNotNull prepend="," property="deleteVersion">
                delete_version
            </isNotNull>
            <isNotNull prepend="," property="gmtCreated">
                gmt_created
            </isNotNull>
            <isNotNull prepend="," property="gmtModified">
                gmt_modified
            </isNotNull>
            )
        </dynamic>
        values
        <dynamic prepend="(">
            <isNotNull prepend="," property="id">
                #id:BIGINT#
            </isNotNull>
            <isNotNull prepend="," property="bizCode">
                #bizCode:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="sellerId">
                #sellerId:BIGINT#
            </isNotNull>
            <isNotNull prepend="," property="groupId">
                #groupId:BIGINT#
            </isNotNull>
            <isNotNull prepend="," property="itemId">
                #itemId:BIGINT#
            </isNotNull>
            <isNotNull prepend="," property="deleteMark">
                #deleteMark:TINYINT#
            </isNotNull>
            <isNotNull prepend="," property="deleteVersion">
                #deleteVersion:BIGINT#
            </isNotNull>
            <isNotNull prepend="," property="gmtCreated">
                #gmtCreated:TIMESTAMP#
            </isNotNull>
            <isNotNull prepend="," property="gmtModified">
                #gmtModified:TIMESTAMP#
            </isNotNull>
            )
        </dynamic>
    </insert>
    <select id="countByExample" parameterClass="com.mockuai.shopcenter.core.domain.RItemGroupDOExample"
            resultClass="java.lang.Integer">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Wed May 11 10:37:16 CST 2016.
        -->
        select count(*) from r_item_group
        <include refid="r_item_group.Example_Where_Clause"/>
    </select>
    <update id="updateByExampleSelective">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Wed May 11 10:37:16 CST 2016.
        -->
        update r_item_group
        <dynamic prepend="set">
            <isNotNull prepend="," property="record.id">
                id = #record.id:BIGINT#
            </isNotNull>
            <isNotNull prepend="," property="record.bizCode">
                biz_code = #record.bizCode:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="record.sellerId">
                seller_id = #record.sellerId:BIGINT#
            </isNotNull>
            <isNotNull prepend="," property="record.groupId">
                group_id = #record.groupId:BIGINT#
            </isNotNull>
            <isNotNull prepend="," property="record.itemId">
                item_id = #record.itemId:BIGINT#
            </isNotNull>
            <isNotNull prepend="," property="record.deleteMark">
                delete_mark = #record.deleteMark:TINYINT#
            </isNotNull>
            <isNotNull prepend="," property="record.deleteVersion">
                delete_version = #record.deleteVersion:BIGINT#
            </isNotNull>
            <isNotNull prepend="," property="record.gmtCreated">
                gmt_created = #record.gmtCreated:TIMESTAMP#
            </isNotNull>
            <isNotNull prepend="," property="record.gmtModified">
                gmt_modified = #record.gmtModified:TIMESTAMP#
            </isNotNull>
        </dynamic>
        <isParameterPresent>
            <include refid="r_item_group.Example_Where_Clause"/>
        </isParameterPresent>
    </update>
    <update id="updateByExample">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Wed May 11 10:37:16 CST 2016.
        -->
        update r_item_group
        set id = #record.id:BIGINT#,
        biz_code = #record.bizCode:VARCHAR#,
        seller_id = #record.sellerId:BIGINT#,
        group_id = #record.groupId:BIGINT#,
        item_id = #record.itemId:BIGINT#,
        delete_mark = #record.deleteMark:TINYINT#,
        delete_version = #record.deleteVersion:BIGINT#,
        gmt_created = #record.gmtCreated:TIMESTAMP#,
        gmt_modified = #record.gmtModified:TIMESTAMP#
        <isParameterPresent>
            <include refid="r_item_group.Example_Where_Clause"/>
        </isParameterPresent>
    </update>
    <update id="updateByPrimaryKeySelective" parameterClass="com.mockuai.shopcenter.core.domain.RItemGroupDO">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Wed May 11 10:37:16 CST 2016.
        -->
        update r_item_group
        <dynamic prepend="set">
            <isNotNull prepend="," property="bizCode">
                biz_code = #bizCode:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="sellerId">
                seller_id = #sellerId:BIGINT#
            </isNotNull>
            <isNotNull prepend="," property="groupId">
                group_id = #groupId:BIGINT#
            </isNotNull>
            <isNotNull prepend="," property="itemId">
                item_id = #itemId:BIGINT#
            </isNotNull>
            <isNotNull prepend="," property="deleteMark">
                delete_mark = #deleteMark:TINYINT#
            </isNotNull>
            <isNotNull prepend="," property="deleteVersion">
                delete_version = #deleteVersion:BIGINT#
            </isNotNull>
            <isNotNull prepend="," property="gmtCreated">
                gmt_created = #gmtCreated:TIMESTAMP#
            </isNotNull>
            <isNotNull prepend="," property="gmtModified">
                gmt_modified = #gmtModified:TIMESTAMP#
            </isNotNull>
        </dynamic>
        where id = #id:BIGINT#
    </update>
    <update id="updateByPrimaryKey" parameterClass="com.mockuai.shopcenter.core.domain.RItemGroupDO">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Wed May 11 10:37:16 CST 2016.
        -->
        update r_item_group
        set biz_code = #bizCode:VARCHAR#,
        seller_id = #sellerId:BIGINT#,
        group_id = #groupId:BIGINT#,
        item_id = #itemId:BIGINT#,
        delete_mark = #deleteMark:TINYINT#,
        delete_version = #deleteVersion:BIGINT#,
        gmt_created = #gmtCreated:TIMESTAMP#,
        gmt_modified = #gmtModified:TIMESTAMP#
        where id = #id:BIGINT#
    </update>
</sqlMap>