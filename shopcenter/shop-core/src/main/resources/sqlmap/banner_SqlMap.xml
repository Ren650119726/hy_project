<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="Banner">

    <typeAlias alias="BannerDO" type="com.mockuai.shopcenter.core.domain.BannerDO"/>
    <typeAlias alias="BannerQTO" type="com.mockuai.shopcenter.domain.qto.BannerQTO"/>

    <resultMap id="BaseResultMap" class="BannerDO">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Mon Jan 11 18:41:21 CST 2016.
        -->
        <result column="id" property="id" jdbcType="BIGINT"/>
        <result column="seller_id" property="sellerId" jdbcType="BIGINT"/>
        <result column="shop_id" property="shopId" jdbcType="BIGINT"/>
        <result column="banner_type" property="bannerType" jdbcType="INTEGER"/>
        <result column="banner_location" property="bannerLocation" jdbcType="INTEGER"/>
        <result column="parent_type" property="parentType" jdbcType="INTEGER"/>
        <result column="parent_id" property="parentId" jdbcType="BIGINT"/>
        <result column="image_url" property="imageUrl" jdbcType="VARCHAR"/>
        <result column="image_desc" property="imageDesc" jdbcType="VARCHAR"/>
        <result column="url" property="url" jdbcType="VARCHAR"/>
        <result column="biz_code" property="bizCode" jdbcType="VARCHAR"/>
        <result column="gmt_created" property="gmtCreated" jdbcType="TIMESTAMP"/>
        <result column="gmt_modified" property="gmtModified" jdbcType="TIMESTAMP"/>
        <result column="delete_mark" property="deleteMark" jdbcType="TINYINT"/>
    </resultMap>

    <sql id="Base_Column_List">
        id, seller_id,shop_id, banner_type, banner_location, parent_type, parent_id, image_url, image_desc,
        url, biz_code, gmt_created, gmt_modified, delete_mark
    </sql>

    <select id="getBanner" resultMap="BaseResultMap"
            parameterClass="BannerDO">
        select
        <include refid="Base_Column_List"/>
        from banner
        where id = #id# and shop_id = #shopId# and biz_code = #bizCode#
    </select>

    <update id="deleteBanner" parameterClass="BannerDO">
        update banner
        set delete_mark = 1 ,gmt_modified = now()
        where id = #id# and shop_id = #shopId# biz_code = #bizCode#
    </update>

    <update id="batchDeleteBanner" parameterClass="BannerQTO">
        update banner
        set delete_mark = 1 ,gmt_modified = now()
        where
        shop_id = #shopId# and biz_code = #bizCode#
        <isNotNull property="idList">
            <isNotEmpty property="idList" prepend="AND">
                id in
                <iterate property="idList" conjunction="," open="(" close=")">
                    #idList[]#
                </iterate>
            </isNotEmpty>
        </isNotNull>
    </update>

    <insert id="addBanner" parameterClass="BannerDO">
        insert into banner
        <dynamic prepend="(">
            <isNotNull prepend="," property="id">
                id
            </isNotNull>
            <isNotNull prepend="," property="sellerId">
                seller_id
            </isNotNull>
            <isNotNull prepend="," property="shopId">
                shop_id
            </isNotNull>
            <isNotNull prepend="," property="bannerType">
                banner_type
            </isNotNull>
            <isNotNull prepend="," property="bannerLocation">
                banner_location
            </isNotNull>
            <isNotNull prepend="," property="parentType">
                parent_type
            </isNotNull>
            <isNotNull prepend="," property="parentId">
                parent_id
            </isNotNull>
            <isNotNull prepend="," property="imageUrl">
                image_url
            </isNotNull>
            <isNotNull prepend="," property="imageDesc">
                image_desc
            </isNotNull>
            <isNotNull prepend="," property="url">
                url
            </isNotNull>
            <isNotNull prepend="," property="bizCode">
                biz_code
            </isNotNull>
            ,gmt_created
            ,gmt_modified
            ,delete_mark
            )
        </dynamic>
        values
        <dynamic prepend="(">
            <isNotNull prepend="," property="id">
                #id:BIGINT#
            </isNotNull>
            <isNotNull prepend="," property="sellerId">
                #sellerId:BIGINT#
            </isNotNull>
            <isNotNull prepend="," property="shopId">
                #shopId:BIGINT#
            </isNotNull>
            <isNotNull prepend="," property="bannerType">
                #bannerType:INTEGER#
            </isNotNull>
            <isNotNull prepend="," property="bannerLocation">
                #bannerLocation:INTEGER#
            </isNotNull>
            <isNotNull prepend="," property="parentType">
                #parentType:INTEGER#
            </isNotNull>
            <isNotNull prepend="," property="parentId">
                #parentId:BIGINT#
            </isNotNull>
            <isNotNull prepend="," property="imageUrl">
                #imageUrl:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="imageDesc">
                #imageDesc:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="url">
                #url:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="bizCode">
                #bizCode:VARCHAR#
            </isNotNull>
            ,now()
            ,now()
            ,0
            )
        </dynamic>
        <selectKey keyProperty="id" resultClass="Long">
            select LAST_INSERT_ID();
        </selectKey>
    </insert>

    <sql id="queryWhere">
        where delete_mark = 0
        <isNotNull property="id" prepend="AND">
            id = #id#
        </isNotNull>
        <isNotNull property="idList">
            <isNotEmpty property="idList" prepend="AND">
                id in
                <iterate property="idList" conjunction="," open="(" close=")">
                    #idList[]#
                </iterate>
            </isNotEmpty>
        </isNotNull>
        <isNotNull property="sellerId" prepend="AND">
            seller_id = #sellerId#
        </isNotNull>
        <isNotNull property="shopId" prepend="AND">
            shop_id = #shopId#
        </isNotNull>
        <isNotNull property="bizCode" prepend="AND">
            biz_code = #bizCode#
        </isNotNull>
        <isNotNull property="bannerType" prepend="AND">
            banner_type = #bannerType#
        </isNotNull>
        <isNotNull property="parentType" prepend="AND">
            parent_type = #parentType#
        </isNotNull>
        <isNotNull property="parentId" prepend="AND">
            parent_id = #parentId#
        </isNotNull>
    </sql>

    <select id="countBanner" parameterClass="BannerQTO" resultClass="java.lang.Integer">
        select count(1) from banner
        <include refid="queryWhere"/>
    </select>

    <select id="queryBanner" parameterClass="BannerQTO" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from banner
        <include refid="queryWhere"/>
        order by gmt_created desc
        <isNotNull property="needPaging">
            <isEqual property="needPaging" compareValue="true">
                limit #offset#,#page_size#
            </isEqual>
        </isNotNull>
    </select>


    <!--<update id="updateByExampleSelective">-->
        <!--&lt;!&ndash;-->
          <!--WARNING - @mbggenerated-->
          <!--This element is automatically generated by MyBatis Generator, do not modify.-->
          <!--This element was generated on Mon Jan 11 18:41:21 CST 2016.-->
        <!--&ndash;&gt;-->
        <!--update banner-->
        <!--<dynamic prepend="set">-->
            <!--<isNotNull prepend="," property="record.id">-->
                <!--id = #record.id:BIGINT#-->
            <!--</isNotNull>-->
            <!--<isNotNull prepend="," property="record.sellerId">-->
                <!--seller_id = #record.sellerId:BIGINT#-->
            <!--</isNotNull>-->
            <!--<isNotNull prepend="," property="record.bannerType">-->
                <!--banner_type = #record.bannerType:INTEGER#-->
            <!--</isNotNull>-->
            <!--<isNotNull prepend="," property="record.bannerLoaction">-->
                <!--banner_location = #record.bannerLoaction:INTEGER#-->
            <!--</isNotNull>-->
            <!--<isNotNull prepend="," property="record.parentType">-->
                <!--parent_type = #record.parentType:INTEGER#-->
            <!--</isNotNull>-->
            <!--<isNotNull prepend="," property="record.parentId">-->
                <!--parent_id = #record.parentId:BIGINT#-->
            <!--</isNotNull>-->
            <!--<isNotNull prepend="," property="record.imageUrl">-->
                <!--image_url = #record.imageUrl:VARCHAR#-->
            <!--</isNotNull>-->
            <!--<isNotNull prepend="," property="record.imageDesc">-->
                <!--image_desc = #record.imageDesc:VARCHAR#-->
            <!--</isNotNull>-->
            <!--<isNotNull prepend="," property="record.url">-->
                <!--url = #record.url:VARCHAR#-->
            <!--</isNotNull>-->
            <!--<isNotNull prepend="," property="record.bizCode">-->
                <!--biz_code = #record.bizCode:VARCHAR#-->
            <!--</isNotNull>-->
            <!--<isNotNull prepend="," property="record.gmtCreated">-->
                <!--gmt_created = #record.gmtCreated:TIMESTAMP#-->
            <!--</isNotNull>-->
            <!--<isNotNull prepend="," property="record.gmtModified">-->
                <!--gmt_modified = #record.gmtModified:TIMESTAMP#-->
            <!--</isNotNull>-->
            <!--<isNotNull prepend="," property="record.deleteMark">-->
                <!--delete_mark = #record.deleteMark:TINYINT#-->
            <!--</isNotNull>-->
        <!--</dynamic>-->
        <!--<isParameterPresent>-->
            <!--<include refid="banner.Example_Where_Clause"/>-->
        <!--</isParameterPresent>-->
    <!--</update>-->
    <!--<update id="updateByExample">-->
        <!--&lt;!&ndash;-->
          <!--WARNING - @mbggenerated-->
          <!--This element is automatically generated by MyBatis Generator, do not modify.-->
          <!--This element was generated on Mon Jan 11 18:41:21 CST 2016.-->
        <!--&ndash;&gt;-->
        <!--update banner-->
        <!--set id = #record.id:BIGINT#,-->
        <!--seller_id = #record.sellerId:BIGINT#,-->
        <!--banner_type = #record.bannerType:INTEGER#,-->
        <!--banner_location = #record.bannerLoaction:INTEGER#,-->
        <!--parent_type = #record.parentType:INTEGER#,-->
        <!--parent_id = #record.parentId:BIGINT#,-->
        <!--image_url = #record.imageUrl:VARCHAR#,-->
        <!--image_desc = #record.imageDesc:VARCHAR#,-->
        <!--url = #record.url:VARCHAR#,-->
        <!--biz_code = #record.bizCode:VARCHAR#,-->
        <!--gmt_created = #record.gmtCreated:TIMESTAMP#,-->
        <!--gmt_modified = #record.gmtModified:TIMESTAMP#,-->
        <!--delete_mark = #record.deleteMark:TINYINT#-->
        <!--<isParameterPresent>-->
            <!--<include refid="banner.Example_Where_Clause"/>-->
        <!--</isParameterPresent>-->
    <!--</update>-->
    <!--<update id="updateByPrimaryKeySelective" parameterClass="com.mockuai.shopcenter.core.domain.BannerDO">-->
        <!--&lt;!&ndash;-->
          <!--WARNING - @mbggenerated-->
          <!--This element is automatically generated by MyBatis Generator, do not modify.-->
          <!--This element was generated on Mon Jan 11 18:41:21 CST 2016.-->
        <!--&ndash;&gt;-->
        <!--update banner-->
        <!--<dynamic prepend="set">-->
            <!--<isNotNull prepend="," property="sellerId">-->
                <!--seller_id = #sellerId:BIGINT#-->
            <!--</isNotNull>-->
            <!--<isNotNull prepend="," property="bannerType">-->
                <!--banner_type = #bannerType:INTEGER#-->
            <!--</isNotNull>-->
            <!--<isNotNull prepend="," property="bannerLoaction">-->
                <!--banner_location = #bannerLoaction:INTEGER#-->
            <!--</isNotNull>-->
            <!--<isNotNull prepend="," property="parentType">-->
                <!--parent_type = #parentType:INTEGER#-->
            <!--</isNotNull>-->
            <!--<isNotNull prepend="," property="parentId">-->
                <!--parent_id = #parentId:BIGINT#-->
            <!--</isNotNull>-->
            <!--<isNotNull prepend="," property="imageUrl">-->
                <!--image_url = #imageUrl:VARCHAR#-->
            <!--</isNotNull>-->
            <!--<isNotNull prepend="," property="imageDesc">-->
                <!--image_desc = #imageDesc:VARCHAR#-->
            <!--</isNotNull>-->
            <!--<isNotNull prepend="," property="url">-->
                <!--url = #url:VARCHAR#-->
            <!--</isNotNull>-->
            <!--<isNotNull prepend="," property="bizCode">-->
                <!--biz_code = #bizCode:VARCHAR#-->
            <!--</isNotNull>-->
            <!--<isNotNull prepend="," property="gmtCreated">-->
                <!--gmt_created = #gmtCreated:TIMESTAMP#-->
            <!--</isNotNull>-->
            <!--<isNotNull prepend="," property="gmtModified">-->
                <!--gmt_modified = #gmtModified:TIMESTAMP#-->
            <!--</isNotNull>-->
            <!--<isNotNull prepend="," property="deleteMark">-->
                <!--delete_mark = #deleteMark:TINYINT#-->
            <!--</isNotNull>-->
        <!--</dynamic>-->
        <!--where id = #id:BIGINT#-->
    <!--</update>-->
    <!--<update id="updateByPrimaryKey" parameterClass="com.mockuai.shopcenter.core.domain.BannerDO">-->
        <!--&lt;!&ndash;-->
          <!--WARNING - @mbggenerated-->
          <!--This element is automatically generated by MyBatis Generator, do not modify.-->
          <!--This element was generated on Mon Jan 11 18:41:21 CST 2016.-->
        <!--&ndash;&gt;-->
        <!--update banner-->
        <!--set seller_id = #sellerId:BIGINT#,-->
        <!--banner_type = #bannerType:INTEGER#,-->
        <!--banner_location = #bannerLoaction:INTEGER#,-->
        <!--parent_type = #parentType:INTEGER#,-->
        <!--parent_id = #parentId:BIGINT#,-->
        <!--image_url = #imageUrl:VARCHAR#,-->
        <!--image_desc = #imageDesc:VARCHAR#,-->
        <!--url = #url:VARCHAR#,-->
        <!--biz_code = #bizCode:VARCHAR#,-->
        <!--gmt_created = #gmtCreated:TIMESTAMP#,-->
        <!--gmt_modified = #gmtModified:TIMESTAMP#,-->
        <!--delete_mark = #deleteMark:TINYINT#-->
        <!--where id = #id:BIGINT#-->
    <!--</update>-->
</sqlMap>